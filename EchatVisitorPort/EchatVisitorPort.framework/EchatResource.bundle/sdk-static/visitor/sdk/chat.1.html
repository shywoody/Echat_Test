<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title></title>
    <base href="../../">
    <meta http-equiv="Content-type" content="text/html;charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="Pragma" content="no-cache">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <!--<meta name="format-detection" content="telephone=no">-->
    <meta name="MobileOptimized" content="320">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" type="text/css" href="/visitor/sdk/css/style.css">
    <style rel="stylesheet" type="text/css">
        html #__vconsole .vc-switch {
            z-index: 99999999;
            bottom:120px;
        }
        html #__vconsole .vc-content{
            height:370px;
            overflow: hidden !important;
            background: red;
        }
        html #__vconsole .vc-logbox:first-child{
            top:0 !important;
        }
    </style>
    <script type="text/javascript" src="js/vconsole.js"></script>
    <script type="text/javascript">

    window.addEventListener('load', function () {
        setTimeout(function () {
            var vConsoleScroll = new IScroll(document.querySelector('.vc-content'));
            setInterval(function () {
                vConsoleScroll.refresh();
            }, 2000)
        }, 2000)
    });
    var vConsole = new VConsole(); 
    
        (function() {
            window.SDK = navigator.userAgent.match(/Android/i)?'Android':'IOS';
            window.wkWebkit = navigator.userAgent.match(/Echat_WKWeb|iphone|ipod|ipad/i);
            window.__uri = function(str){
               return '../../'+str;
            }
            window.base

            function getQueryString(name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                var r = location.search.substr(1).match(reg);
                if (r != null) {
                    return decodeURIComponent(r[2]);
                }
                return '';
            }

            var host = location.host;
            var lan = window.EchatJsBridge&&EchatJsBridge.callEchatNative&&EchatJsBridge.callEchatNative(JSON.stringify({"functionName": "getLan"}));
            var n = '';
            console.log("lan:"+lan);

            //加载后台数据的地址
            var dataHost = getQueryString('dataHost');
            if(dataHost&&dataHost.match(/^http[s]?:\/\/[^\/]+/)){
                //来自浏览页的服务端参数地址
                window.dataHost = location.protocol + '//' + dataHost.match(/^http[s]?:\/\/([^\/]+)/)[1];
            }else if(host.match(/^([^\.]+)s\./)){
                //wwws.echatsoft.com-->www.echatsoft.com
                window.dataHost = location.protocol +'//' + host.replace(/^([^\.]+)s\./,"$1.");
            }else{
                //直接访问的后端域名
                window.dataHost = location.protocol + '//' + host;
            }
            window.mainDomain = location.host.replace(/(^[^.]+.)|(:\.+$)/,'')
            //加载访客ID ysc
            var pa = location.search,
                    vid,
                    encyptVid,
                    pn;
            if (pa) {
                pa = pa.substring(1).split('&');
                if (pa.length) {
                    for (var i = 0; i < pa.length; i++) {
                        pn = pa[i].split('=');
                        if ((pn[0] == 'encryptVID' || pn[0] == 'chatVisitorId' || pn[0] == 'companyId') && pn[1]) {
                            window[pn[0]] = decodeURIComponent(pn[1]);
                        }
                    }
                }
            }
           /*  if (!window.encryptVID || !window.chatVisitorId) {
                document.write('<scr'+n+'ipt src="'+window.dataHost +'\/ysc?companyId=' + window.companyId + '&t=' + (new Date().getTime()) + '"></scr'+n+'ipt>');
            } */

            //加载语言文件，这和后端一致
            var lang = window.lanName = lan || getQueryString('lan') || navigator.language || navigator.browserLanguage || 'zh-CN';
            lang = lang.toLowerCase().replace("_", '-');
            window.supportLang = {
                zhcn: "../common/lang/langzhcn.js",
                enus: "../common/lang/langenus.js",
                fr: "../common/lang/langfr.js",
                ja: "../common/lang/langja.js",
                de: "../common/lang/langde.js",
                ko: "../common/lang/langko.js",
                zhtw: "../common/lang/langzhtw.js"
            }
            //这个用来加载资源，这里有支持语言的列表,需要在增加语种的时候也维护这里的列表
            var path = lang.replace('-', ''),
                    langPf = lang.split('-')[0],
                    langMap = {zhhk: 'zhtw', zhmo: 'zhtw', zhcht: 'zhtw', zhsg: 'zhcn', jp: 'ja'};
            if (!supportLang[path]) {
                if( langMap[path] ){//不支持的，找转换列表的
                    path = langMap[path];
                }else{
                    path = 'zhcn';//默认
                    for(var sl in supportLang){//类似语种
                        if(sl.indexOf(langPf)==0){
                            path = sl
                            break;
                        }
                    }
                }
            }
            window.lanResName = path;
            document.write('<scr'+n+'ipt src="' + supportLang[path] + '"></scr'+n+'ipt>');
        }());
    </script>

    <!--<script id="langScript" type="text/javascript" src="../common/lang/langzhCN.js"></script>-->
</head>
<body>
<div id="loading" class="loading">
    <!--<div class="loading-wrap">-->
    <img class="loading-img" src="../common/img/loading.gif" style="height:75px;height:75px;margin-top:-37px;margin-left: -37px;" onload="this.style.visibility='visible';">
    <!--</div>-->
</div>

<div id="mask" class="mask hide"></div>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <!--<button class="pswp__button pswp__button&#45;&#45;fs" title="Toggle fullscreen"></button>-->
                <button class="pswp__button pswp__button--download" id="pswpDownload" langs="downloadSourceImg"></button>
                <!--<button class="pswp__button pswp__button&#45;&#45;zoom" title="Zoom in/out"></button>-->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!--
                            <button class="pswp__button pswp__button&#45;&#45;arrow&#45;&#45;left" title="Previous (arrow left)">
                            </button>

                            <button class="pswp__button pswp__button&#45;&#45;arrow&#45;&#45;right" title="Next (arrow right)">
                            </button>-->
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<!--</div>-->

<!-- 路由入口  -->
<div id="router" class="router"></div>
<ul id="verify" class="verify hide">
    <li langs="validCodeTip">请输入验证码进行对话</li>
    <li>
        <input type="text" id="verify_input">
    </li>
    <li class="clearfix">
        <img alt="验证码" id="verify_img" langs="validCode"><span class="color0 cursor-p" id="verify_change" langs="nextPic">&nbsp;换一张&nbsp;</span>
    </li>
    <li class="clearfix">
        <div class="bg0 cursor-p radius4" id="verify_ok" langs="okay">确定</div>
    </li>
</ul>
<div class="entry entry-wrap" id="entry">
</div>
<div id="satisfy" class="satisfy hide">
    <div class="sa-title tc" langs="evaluate">满意度评价</div>
    <div id="satisfyContent" class="sa-content">
        <div id="satisfyConfig">
        </div>
        <div>
            <input type="hidden" id="satisfy_ipt" value="5">
            <textarea id="sa_advise" langs="suggestHolder" placeholder="建议："></textarea>
        </div>
    </div>
    <div class="sa-btn-line clearfix">
        <div id="sa_ok" class="fl sa-btn bg0" langs="submit">提交</div>
    </div>
</div>
<!-- 和留言验证使用同一个ID 不共存。 -->
<div class="leave-tip tiphide" id="leave_tip">
    <div class="leave-tip-content radius4">
        <div class="info-warn"></div>
        <div class="info-con" id="leave_tip_con"></div>
    </div>
</div>
<!--客服信息页面，等到对话初始化OK后再写入，写入OK后 在对话界面显示 进入 按钮-->
<div id="detail" class="wrapper page hide bg5" style="z-index: -10">
    <div class="scroller">
        <div id="portrait" class="portrait box bg0">
        </div>
        <div id="info_list" class="infolist">
        </div>
    </div>
</div>

<div id="chat" class="page bg4">
    <header id="header" class="header bg0 box">
        <div class="header-logo"><a id="mini_btn" class="header-btn-back">
            <!--<img class="header-back-img"  />-->
            返回
        </a></div>
        <a class="header-title" id="staffName" langs="waitting">请稍等...</a>
        <div class="header-btn">
            <a id="close_btn" class="header-btn-close btn-close action-close">
                <!--<img class="header-close-img" />-->
                关闭
            </a>
        </div>
    </header>
    <div id="container" class="container bg4">
        <!--<div id="maskVerify" class="mask hide"></div>-->

        <div id="pastePreview" class="paste-pre hide">
            <img id="pasteImg" class="paste-img">

            <div id="pasteError" class="tc error hide" langs="sendFail">发送失败</div>
            <div class="clearfix paste-btn">
                <div id="pasteCancel" class="paste-cancel fl cursor-p radius4" langs="cancel">取消</div>
                <div id="pasteOK" class="paste-ok fr bg0 cursor-p radius4" langs="send">发送</div>
            </div>
        </div>
        <div id="unread" class="unread">
            <div id="unread_tip" class="unread-tip">
            </div>
            <div id="unread_wrap" class="unread-wrap">
                <ul id="list_unread" class="list-unread">
                </ul>
            </div>
            <div id="unread_close" class="unread-close"><i></i></div>
        </div>
        <section id="content" class="content">
            <div id="list_his" class="list-his">
                <div id="pre_his" class="pre-his">
                    <i class="hr-left"></i><i class="pre-his-icon"></i><span langs="preHistory">查看更多消息</span><i class="hr-right"></i>
                </div>
                <ul id="list_msg" class="list-msg">
                    <li class="clearfix list-his-hr color1 hide"><i class="hr-left"></i><span langs="currentChat">本次对话</span><i class="hr-right"></i></li>
                </ul>
            </div>
        </section>
    </div>
    <section id="footer" class="footer bg2">
        <!--输入联想-->
        <div id="input_suggest" class="ipt-suggest hide"></div>
        <div id="robotToStaff" class="menu-robot-staff"><i class="robot-staff-icon"></i><span id="toHumanWords">如您的问题未被解决,可进入</span><span id="robotToStaffWord" class="bg0" langs="robotToStaff">人工服务</span><i class="robot-staff-close"></i></div>
        <div id="leaveBar" class="leave-bar leave-bar-btn bg0" langs="leaveToChatBtn"></div>
        <!--box<a id="input_menu" class="input-menu" actionname="showMenu"><img src="css/img/more.png"/></a>-->
        <div id="chat_text" class="input flex">
            <div class="record-switch icon-record icon"></div>
            <div class="btn-record flex1">按住&nbsp;&nbsp;说话</div>
            <textarea class="flex1 radius4" id="textInput" placeholder="请输入..." langs="textareaInput"></textarea>
            <div class="menu-emo" id="menu_emotion" type="emotion" title="表情" langs="emotion">
                <div class="menu-item-icon icon"></div>
            </div>
            <div id="enter_btn" class="enter-btn bg0 radius4 hide" langs="send">发送</div>
            <div id="menu_more" class="menu-more menu-more-robot"><div class="menu-item-icon icon menu-more-i"></div></div>
            <div id="fakeInput"></div>
        </div>
        <!-- 工具按钮    -->
        <form name="uploadForm" id="uploadForm" style="position: absolute; opacity:0.01;left:-1000px;top:-100px;" enctype="multipart/form-data"><input type="file" name="file" id="uploadInput"></form>
        <div id="toolbar" class="hide toolbar">
            <ul class="menu">
                <li id="menu_file" class="menu-item menu-camera" type="file">
                    <div class="menu-item-icon icon"></div>
                </li>
                <li id="menu_file2" class="menu-item menu-file" type="file">
                    <div class="menu-item-icon icon"></div>
                </li>
                <li id="menuSatisfy" class="menu-item menu-satisfy hide" type="satisfy">
                    <div class="menu-item-icon icon"></div>
                </li>
                <li id="menu_phone" class="menu-item menu-phone hide" type="phone">
                    <a class="menu-phone-a" target="_blank">
                        <div class="menu-item-icon icon"></div>
                    </a>
                </li>
            </ul>
            <!--<div id="menu_more" class="menu-more"><i class="menu-more-i"></i></div>-->
        </div>
        <div id="urlList" class="url-list hide">
            <div class="url-list-wrap transition box" id="urlListWrap">
                <ul class="clearfix url-list-page flex1">
                <li class="list-url-item menu-file" data-index="0">
                    <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">相册</div>
                </li>
                <li class="list-url-item menu-camera" data-index="1">
                    <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">相机</div>
                </li>
             <!--   <li class="list-url-item menu-video" data-index="2">
                    <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">小视频</div>
                </li>-->
                <li class="list-url-item menu-map" data-index="2">
                    <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">位置</div>
                </li>
                <li class="list-url-item menu-phone" data-index="3">
                    <a class="menu-phone-a" target="_blank">
                     <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">电话</div>
                    </a>
                </li>
                <li class="list-url-item menu-satisfy" data-index="4">
                    <div class="list-url-img">
                        <div class="menu-item-icon icon"></div>
                    </div>
                    <div class="list-url-title">满意度</div>
                </li>
                </ul>
            </div>
            <ul id="url_dot_list" class="dot-list hover">
            </ul>
        </div>

        <div id="emotion" class="tool-item emotion hide">
            <ul id="emo_list" class="emo-list box">
                <li class="emo-page hover flex1">
                    <ul class="clearfix box tc">
                        <li class="emoji" code="U+1F601">&#128017;</li>
                    </ul>
                </li>
            </ul>
            <ul id="emo_dot_list" class="dot-list hover">
                <li class="dot-list-li hover">0</li>
                <li class="dot-list-li">1</li>
            </ul>
        </div>
    </section>

    <section class="hide">
        <div id="voice"></div>
    </section>
</div>

<div id="leave" class="leave page bg4 hide">
    <div class="container">
        <div id="leave_disable" class="hide" style="position: absolute;top:50%;left:50%;width:180px;height:120px;margin-left:-90px;margin-top:-60px;">
            <img id="leave_disable_icon" style="display: block;border:0;width:180px" langs="offlineTip" alt="没有在线的客服哦">
        </div>
    </div>
</div>
<!-- 对话记录中识别出的URL展示 -->
<div id="visitorSite" class="site bg4 hide"></div>
<!-- 样式中配置的URL列表展示 -->
<div id="menuSite" class="menu-site bg4 transition"></div>
<div style="position: absolute;top:-100px;z-index: -10;">
    <audio>
        <!-- <source src="/res/sounds/msg.mp3" type="audio/mp3"> -->
        <!-- <source src="/res/sounds/msg.wav" type="audio/wav"> -->
        Your browser does not support the audio tag.
    </audio>
    <div id="wechatTempFrame"></div>
    <!-- 帮助下载 -->
    <iframe id="downFile" name="downFile" style="display:none;"></iframe>
    <!-- iosapi -->
    <iframe id="apiFrame" name="apiFrame" style="display:none;"></iframe>
</div>
<div class="record-wrap">
    <div class="record-wrap-icons">
        <div class="icon-record-mic flex">
            <div class="record-wrap-icon icon"></div>
            <div class="icon-record-sound icon icon-record-sound0"></div>
        </div>
        <div class="icon-record-countdown">10</div>
        <div class="icon-record-cancel">
            <div class="record-wrap-icon icon"></div>
        </div>
    </div>
    <div class="record-wrap-cancel1">手指上滑,取消发送</div>
    <div class="record-wrap-cancel2"><span>松开手指,取消发送</span></div>

</div>

<script>
    try {
        window.scrollTop = 0;
        window.scrollTo(0, 0);
        document.body.scrollTop = 0;
    } catch (e) {
    }
</script>
<script type="text/javascript" src="js/chat.js"></script>
<script type="text/javascript" src="js/chatlib.js"></script>
<!--<script type="text/javascript" src="/visitor/mobile/js/chatlib.js"></script>-->
</body>
</html>